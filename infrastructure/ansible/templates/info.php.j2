<?php
// This file is for testing and diagnostics only.
// IP-based access restriction
$allowed_ips = array(
    '127.0.0.1',
    '::1',
    '{{ hostvars[groups["bastion"][0]]["ansible_host"] }}',
{% for host in groups['webservers'] %}
    '{{ hostvars[host]["ansible_host"] }}',
{% endfor %}
);

if (!in_array($_SERVER['REMOTE_ADDR'], $allowed_ips)) {
    header('HTTP/1.0 403 Forbidden');
    exit('Access denied');
}

// Display PHP information
phpinfo();
?>